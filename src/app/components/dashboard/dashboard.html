<div class="dashboard" *ngIf="dashboardData$ | async as data; else loadingTemplate">
  <div class="stats-grid">
    <app-stats-card icon="🏆" iconClass="green" label="Completed Courses" [value]="data.stats.completed" (click)="openCompleted()"></app-stats-card>
    <app-stats-card icon="📚" iconClass="blue" label="Enrolled Courses" [value]="data.stats.enrolled" (click)="openEnrolled()"></app-stats-card>
    <app-stats-card icon="⏰" iconClass="orange" label="Hours Learned" [value]="data.stats.hours" (click)="openHours()"></app-stats-card>
  </div>

  <div class="content-grid">
    <aside class="filters">
      <h3>Search Filters</h3>
      <div class="filter">
        <label>Category</label>
        <select [(ngModel)]="filters.category" (ngModelChange)="applyFilters()">
          <option value="">All</option>
          <option *ngFor="let c of data.categories" [value]="c">{{ c }}</option>
        </select>
      </div>
      <div class="filter">
        <label>Topic</label>
        <select [(ngModel)]="filters.topic" (ngModelChange)="applyFilters()">
          <option value="">All</option>
          <option *ngFor="let t of data.topics" [value]="t">{{ t }}</option>
        </select>
      </div>
      <div class="filter">
        <label>Instructor</label>
        <select [(ngModel)]="filters.instructor" (ngModelChange)="applyFilters()">
          <option value="">All</option>
          <option *ngFor="let i of data.instructors" [value]="i">{{ i }}</option>
        </select>
      </div>
    </aside>

    <main class="catalog">
      <h2>Course Catalog</h2>
      <div class="course-list">
        <app-course-card
          *ngFor="let course of data.catalog"
          [course]="course"
          [enrollment]="getEnrollmentFor(course.id)"
          (continueClick)="onContinueLearning($event)"
          (enrollClick)="onCourseEnroll($event)">
        </app-course-card>
      </div>
    </main>

    <section class="my-learning" *ngIf="data.continueCourse">
      <h3>My Learning</h3>
      <button class="continue-btn" (click)="onContinueLearning(data.continueCourse.id)">
        {{ data.continueCourse.title }} – {{ data.continueCourse.progress || 0 }}% complete
      </button>
    </section>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading...</p>
  </div>
</ng-template>
